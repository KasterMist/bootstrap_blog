<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Posts on Kaster Mist's Blog</title><link>https://KasterMist.com/posts/</link><description>Recent content in Posts on Kaster Mist's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>Copyright Â© 2000-2024 Kaster Mist. All Rights Reserved.</copyright><lastBuildDate>Fri, 14 Jun 2024 09:31:02 +0800</lastBuildDate><atom:link href="https://KasterMist.com/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>Vimç”¨æ³• (å››) ä»£ç è·³è½¬è¯¦è§£</title><link>https://KasterMist.com/posts/linux/vim-4/</link><pubDate>Fri, 14 Jun 2024 09:31:02 +0800</pubDate><guid>https://KasterMist.com/posts/linux/vim-4/</guid><description>&lt;p>ä½¿ç”¨vimåœ¨å¤„ç†ç®€å•çš„ä»£ç æ–‡ä»¶çš„æ—¶å€™éå¸¸æ–¹ä¾¿ã€‚ä½†æ˜¯å¦‚æœæƒ³è¦å¤„ç†ä¸€ä¸ªå¤§å‹é¡¹ç›®çš„è¯ï¼Œåˆ™è¾ƒä¸ºéº»çƒ¦ã€‚å› ä¸ºæµè§ˆå¤§å‹é¡¹ç›®éœ€è¦ä¸æ–­è·³è½¬ä»£ç ï¼Œæ‰€ä»¥è¿™ç¯‡åšå®¢å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨vimè¿›è¡Œä»£ç è·³è½¬ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/vim.png" length="11793" type="image/.png"/></item><item><title>Vimç”¨æ³• (ä¸‰) -- ç®¡ç†å¤šä¸ªæ–‡ä»¶</title><link>https://KasterMist.com/posts/linux/vim-3/</link><pubDate>Thu, 13 Jun 2024 16:57:11 +0800</pubDate><guid>https://KasterMist.com/posts/linux/vim-3/</guid><description>&lt;p>è¿™éƒ¨åˆ†å°†ç€é‡ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨vimæ‰“å¼€å¤šä¸ªæ–‡ä»¶ä»¥åŠå¦‚ä½•ç®¡ç†æ‰“å¼€çš„æ–‡ä»¶ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/vim.png" length="11793" type="image/.png"/></item><item><title>Vimç”¨æ³• (äºŒ) -- æ’å…¥æ¨¡å¼æ‹“å±•</title><link>https://KasterMist.com/posts/linux/vim-2/</link><pubDate>Wed, 12 Jun 2024 16:16:02 +0800</pubDate><guid>https://KasterMist.com/posts/linux/vim-2/</guid><description>&lt;p>å¤§éƒ¨åˆ†Vimå‘½ä»¤éƒ½æ˜¯åœ¨éæ’å…¥æ¨¡å¼ä¸­æ‰§è¡Œï¼Œä¸è¿‡æ’å…¥æ¨¡å¼ä¸­ä»æœ‰ä¸€äº›èƒ½å¤Ÿæé«˜æ•ˆç‡çš„åŠŸèƒ½ã€‚è¿™ç¯‡åšå®¢å°†ä¸»è¦ä»‹ç»æ’å…¥æ¨¡å¼çš„ä¸€äº›æœ‰ç”¨çš„åŠŸèƒ½ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/vim.png" length="11793" type="image/.png"/></item><item><title>ä½¿ç”¨Cronè°ƒæ•´MACå¤–è§‚</title><link>https://KasterMist.com/posts/linux/%E4%BD%BF%E7%94%A8cron%E8%B0%83%E6%95%B4mac%E5%A4%96%E8%A7%82/</link><pubDate>Tue, 11 Jun 2024 16:41:55 +0800</pubDate><guid>https://KasterMist.com/posts/linux/%E4%BD%BF%E7%94%A8cron%E8%B0%83%E6%95%B4mac%E5%A4%96%E8%A7%82/</guid><description>&lt;p>æœ¬äººä½¿ç”¨macbookä¸€èˆ¬éƒ½ä¼šè®¾ç½®æŠ¤çœ¼æ¨¡å¼ï¼Œå³å¤œè§ˆæ¨¡å¼ã€‚ç„¶è€Œï¼Œmacbookä¼šè®¤ä¸ºå¤œè§ˆæ¨¡å¼å°±æ˜¯åœ¨æ™šä¸Šæ‰ä¼šå¯ç”¨ã€‚å½“è®¾ç½®ä¸ºæ°¸ä¹…å¤œè§ˆæ¨¡å¼åï¼Œå¦‚æœå°†å¤–è§‚æ¨¡å¼è®¾ç½®ä¸ºè‡ªåŠ¨ï¼Œé‚£ä¹ˆmacbookä¼šé»˜è®¤æ°¸ä¹…ä½¿ç”¨æ·±è‰²å¤–è§‚ã€‚ç„¶è€Œæˆ‘æƒ³è¦å®ç°ç™½å¤©ä¸ºæµ…è‰²å¤–è§‚ï¼Œæ™šä¸Šä¸ºæ·±è‰²å¤–è§‚ã€‚è¿™ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Cronè°ƒåº¦æ¥è‡ªåŠ¨æ›´æ–°MACçš„æµ…è‰²å¤–è§‚å’Œæ·±è‰²å¤–è§‚ã€‚&lt;/p></description></item><item><title>CUDAé›¶ç¢çŸ¥è¯†ç‚¹</title><link>https://KasterMist.com/posts/cuda/cuda%E9%9B%B6%E7%A2%8E%E7%9F%A5%E8%AF%86%E7%82%B9/</link><pubDate>Thu, 06 Jun 2024 09:42:20 +0800</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E9%9B%B6%E7%A2%8E%E7%9F%A5%E8%AF%86%E7%82%B9/</guid><description>&lt;p>åœ¨å­¦ä¹ CUDAè¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œè€Œè¿™äº›é—®é¢˜è¿‡äºé›¶ç¢ï¼Œæ— æ³•è¿›è¡Œç³»ç»ŸåŒ–çš„åˆ†ç±»ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•å¹³æ—¶é‡åˆ°çš„CUDAä½¿ç”¨çš„çŸ¥è¯†ç‚¹ã€‚&lt;/p></description></item><item><title>Git å­¦ä¹  (äº”)</title><link>https://KasterMist.com/posts/git/git_tutorial_5/</link><pubDate>Wed, 22 May 2024 13:53:59 +0800</pubDate><guid>https://KasterMist.com/posts/git/git_tutorial_5/</guid><description>&lt;p>æœ¬ç« å°†ä»‹ç»ä¸€ä¸‹è¿œç¨‹è¿½è¸ªåŠŸèƒ½ä»¥åŠgit push, git fetch, git pullç­‰å‘½ä»¤çš„å‚æ•°è®¾ç½®ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/git.jpg" length="30657" type="image/.jpg"/></item><item><title>Git å­¦ä¹  (å››)</title><link>https://KasterMist.com/posts/git/git_tutorial_4/</link><pubDate>Mon, 20 May 2024 17:04:57 +0800</pubDate><guid>https://KasterMist.com/posts/git/git_tutorial_4/</guid><description>&lt;p>æœ¬ç« å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨git pushå’Œgit pullï¼Œä»¥åŠè¿œç¨‹ä»“åº“çš„ä¸€äº›çŸ¥è¯†ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/git.jpg" length="30657" type="image/.jpg"/></item><item><title>Git å­¦ä¹  (ä¸‰)</title><link>https://KasterMist.com/posts/git/git_tutorial_3/</link><pubDate>Wed, 15 May 2024 13:48:56 +0800</pubDate><guid>https://KasterMist.com/posts/git/git_tutorial_3/</guid><description>&lt;p>æœ¬ç« å°†ç€é‡ä»‹ç»å¦‚ä½•æ›´æ¸…æ™°çš„æ•´ç†æäº¤è®°å½•ï¼Œgit tagå’Œgit describeçš„ç”¨æ³•ï¼Œä»¥åŠä¸€äº›å¤æ‚çš„æ ·ä¾‹æ¥ç†Ÿç»ƒæŒæ¡gitå¸¸ç”¨æŒ‡ä»¤ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/git.jpg" length="30657" type="image/.jpg"/></item><item><title>Git å­¦ä¹  (äºŒ)</title><link>https://KasterMist.com/posts/git/git_tutorial_2/</link><pubDate>Sun, 12 May 2024 16:43:56 +0800</pubDate><guid>https://KasterMist.com/posts/git/git_tutorial_2/</guid><description>&lt;p>æœ¬ç« èŠ‚å°†ä»‹ç»gitçš„ä¸€äº›é«˜çº§æ“ä½œï¼Œè¿™äº›æ“ä½œä¸»è¦ç”¨æ¥å¦‚ä½•åœ¨æäº¤æ ‘ä¸Šè¿›è¡Œç§»åŠ¨ï¼Œæ–¹ä¾¿æ›´çµæ´»çš„æ›´æ”¹åˆ†æ”¯ä»¥åŠæäº¤èŠ‚ç‚¹ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/git.jpg" length="30657" type="image/.jpg"/></item><item><title>Git å­¦ä¹  (ä¸€)</title><link>https://KasterMist.com/posts/git/git_tutorial_1/</link><pubDate>Sat, 11 May 2024 17:02:07 +0800</pubDate><guid>https://KasterMist.com/posts/git/git_tutorial_1/</guid><description><![CDATA[<p>æœ¬æ–‡ç« æ ¹æ®&quot;Learn Git Branching&quot;ç½‘ç«™è¿›è¡Œè®°å½•çŸ¥è¯†ç‚¹ã€‚è¯¥ç½‘ç«™å°†gitæµç¨‹å¯è§†åŒ–ï¼Œå¯ä»¥å¾ˆå¥½çš„å­¦ä¹ gitç›¸å…³çŸ¥è¯†ã€‚å¦‚æœæœ‰å…´è¶£ï¼Œå¯ä»¥è®¿é—®è¯¥ç½‘ç«™: <a href="https://learngitbranching.js.org/?locale=zh_CN" target="_blank" rel="noopener noreferrer">https://learngitbranching.js.org/?locale=zh_CN<i class="fas fa-external-link-square-alt ms-1"></i></a></p>]]></description><enclosure url="https://KasterMist.com/images/logo/git.jpg" length="30657" type="image/.jpg"/></item><item><title>Vscode æ’ä»¶: C/C++</title><link>https://KasterMist.com/posts/vscode/1/</link><pubDate>Wed, 08 May 2024 15:17:44 +0800</pubDate><guid>https://KasterMist.com/posts/vscode/1/</guid><description>&lt;p>æœ¬ç« å°†ä»‹ç»vscodeçš„C/C++æ’ä»¶çš„å…·ä½“ä½¿ç”¨æ–¹æ³•ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/vscode.jpeg" length="7706" type="image/.jpeg"/></item><item><title>Hugo Bootstrap Skeleton Notes</title><link>https://KasterMist.com/posts/hugo_theme_usage_notes/hugo_bootstrap_skeleton/</link><pubDate>Thu, 02 May 2024 16:00:44 +0800</pubDate><guid>https://KasterMist.com/posts/hugo_theme_usage_notes/hugo_bootstrap_skeleton/</guid><description>&lt;p>æœ¬æ–‡ç« ä¸»è¦è®°å½•ä½¿ç”¨åšå®¢æœŸé—´é‡åˆ°çš„æœ‰å…³hugo bootstrap skeletonä¸»é¢˜çš„ä¸€äº›é—®é¢˜ä»¥åŠè§£å†³æ–¹æ³•ã€‚&lt;/p></description></item><item><title>Vimç”¨æ³• (ä¸€)</title><link>https://KasterMist.com/posts/linux/vim/</link><pubDate>Sat, 13 Apr 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/linux/vim/</guid><description>&lt;p>æœ¬ç« èŠ‚å°†ä»‹ç»vimçš„å¸¸ç”¨è¯­æ³•ã€‚&lt;/p></description><enclosure url="https://KasterMist.com/images/logo/vim.png" length="11793" type="image/.png"/></item><item><title>Linux å¸¸ç”¨å‘½ä»¤</title><link>https://KasterMist.com/posts/linux/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</link><pubDate>Thu, 04 Apr 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/linux/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</guid><description><![CDATA[<h2 id="åŸºç¡€å‘½ä»¤" data-numberify>åŸºç¡€å‘½ä»¤<a class="anchor ms-1" href="#åŸºç¡€å‘½ä»¤"></a></h2>

<h4 id="æŸ¥è¯¢æ–‡ä»¶å’Œå­ç›®å½•-ls" data-numberify>æŸ¥è¯¢æ–‡ä»¶å’Œå­ç›®å½• ls<a class="anchor ms-1" href="#æŸ¥è¯¢æ–‡ä»¶å’Œå­ç›®å½•-ls"></a></h4>
<p>æŸ¥è¯¢æ–‡ä»¶å’Œå­ç›®å½•çš„æœ€ç®€å•çš„å‘½ä»¤æ˜¯<code>ls</code>ã€‚å®ƒå¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚å¸¸ç”¨çš„æŒ‡ä»¤æœ‰:</p>
<ul>
<li><code>ls /path/to/directory</code> åˆ—å‡ºæŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•</li>
<li><code>ls -a</code>åˆ—å‡ºéšè—æ–‡ä»¶å’Œå­ç›®å½•</li>
<li><code>ls -l</code>ä»¥è¯¦ç»†æ ¼å¼åˆ—å‡ºæ–‡ä»¶å’Œå­ç›®å½•ï¼ŒåŒ…å«è¯»å†™æƒé™ã€åˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯</li>
</ul>]]></description></item><item><title>CUDAå­¦ä¹ (å)--ä¹¦ç±ä¸­çš„å‡½æ•°æ•´åˆ</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%8D%81-%E4%B9%A6%E7%B1%8D%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E6%95%B4%E5%90%88/</link><pubDate>Mon, 11 Mar 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%8D%81-%E4%B9%A6%E7%B1%8D%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E6%95%B4%E5%90%88/</guid><description>&lt;p>å‰é¢å‡ ç« ä¸»è¦æ˜¯å¯¹å‚è€ƒä¹¦ç›®çš„å†…å®¹è¿›è¡Œä¸€ä¸ªæ¦‚æ‹¬ã€‚æœ¬ç« å°†æ ¹æ®å‚è€ƒä¹¦ç›®çš„å†…å®¹å¯¹æ‰€å­¦åˆ°çš„æ‰€æœ‰å‡½æ•°è¿›è¡Œä¸€ä¸ªæ•´ç†å’Œæ€»ç»“ï¼Œä»¥ä¾¿å¤ä¹ å’Œå‚è€ƒã€‚è‹±ä¼Ÿè¾¾çš„å®˜æ–¹ç½‘ç«™åŒ…å«äº†æ‰€æœ‰çš„CUDAå‡½æ•°ï¼Œå¯å‚è€ƒhttps://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/index.html&lt;/p></description></item><item><title>CUDAå­¦ä¹ (ä¹)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B9%9D/</link><pubDate>Fri, 08 Mar 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B9%9D/</guid><description><![CDATA[<p>è¿™éƒ¨åˆ†æ˜¯åŸºäºåŸå­æ“ä½œç« èŠ‚è¿›è¡Œçš„é«˜çº§æ“ä½œä»‹ç»ï¼Œå³å®ç°é”å®šæ•°æ®ç»“æ„ã€‚</p>
<p>åŸå­æ“ä½œåªèƒ½ç¡®ä¿æ¯ä¸ªçº¿ç¨‹åœ¨å®Œæˆè¯»å–-ä¿®æ”¹-å†™å…¥çš„åºåˆ—ä¹‹å‰ï¼Œå°†ä¸ä¼šæœ‰å…¶ä»–çš„çº¿ç¨‹è¯»å–æˆ–è€…å†™å…¥ç›®æ ‡å†…å­˜ã€‚ç„¶è€Œï¼ŒåŸå­æ“ä½œå¹¶ä¸èƒ½ç¡®ä¿è¿™äº›çº¿ç¨‹å°†æŒ‰ç…§ä½•ç§é¡ºåºæ‰§è¡Œã€‚ä¾‹å¦‚å½“æœ‰ä¸‰ä¸ªçº¿ç¨‹éƒ½æ‰§è¡ŒåŠ æ³•è¿ç®—æ—¶ï¼ŒåŠ æ³•è¿è¡Œçš„æ‰§è¡Œé¡ºåºå¯ä»¥ä¸º(A + B) + Cï¼Œä¹Ÿå¯ä»¥ä¸ºA + (B + C)ã€‚è¿™å¯¹äºæ•´æ•°æ¥è¯´æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºä¸­é—´ç»“æœå¯èƒ½è¢«æˆªæ–­ï¼Œå› æ­¤(A + B) + Cé€šå¸¸å¹¶ä¸ç­‰äºA + (B + c)ã€‚å› æ­¤ï¼Œæµ®ç‚¹æ•°å€¼ä¸Šçš„åŸå­æ•°å­¦è¿ç®—æ˜¯å¦æœ‰ç”¨å°±å€¼å¾—æ€€ç–‘ğŸ¤”ã€‚å› æ­¤åœ¨æ—©æœŸçš„ç¡¬ä»¶ä¸­ï¼Œæµ®ç‚¹æ•°å­¦è¿ç®—å¹¶ä¸æ˜¯ä¼˜å…ˆæ”¯æŒçš„åŠŸèƒ½ã€‚</p>
<p>ç„¶è€Œï¼Œå¦‚æœå¯ä»¥å®¹å¿åœ¨è®¡ç®—ç»“æœä¸­å­˜åœ¨æŸç§ç¨‹åº¦çš„ä¸ç¡®å®šæ€§ï¼Œé‚£ä¹ˆä»ç„¶å¯ä»¥å®Œå…¨åœ¨GPUä¸Šå®ç°å½’çº¦è¿ç®—ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡æŸç§æ–¹å¼æ¥ç»•å¼€åŸå­æµ®ç‚¹æ•°å­¦è¿ç®—ã€‚åœ¨è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸­ä»å°†ä½¿ç”¨åŸå­æ“ä½œï¼Œä½†ä¸æ˜¯ç”¨äºç®—æ•°æœ¬èº«ã€‚</p>]]></description></item><item><title>CUDAå­¦ä¹ (å…«)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%85%AB/</link><pubDate>Thu, 29 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%85%AB/</guid><description><![CDATA[æœ¬ç« å°†ä»‹ç»å¦‚ä½•åˆ†é…å’Œä½¿ç”¨é›¶æ‹·è´å†…å­˜(Zero-Copy Memory)ï¼Œå¦‚ä½•åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å¤šä¸ªGPUï¼Œä»¥åŠå¦‚ä½•åˆ†é…å’Œä½¿ç”¨å¯ç§»åŠ¨çš„å›ºå®šå†…å­˜(Portable Pinned Memory)ã€‚
é›¶æ‹·è´ä¸»æœºå†…å­˜ ä¸Šä¸€ç« ä»‹ç»äº†å›ºå®šå†…å­˜ï¼ˆé¡µé”å®šå†…å­˜ï¼‰ï¼Œè¿™ç§æ–°å‹çš„ä¸»æœºå†…å­˜èƒ½å¤Ÿç¡®ä¿ä¸ä¼šäº¤æ¢å‡ºç‰©ç†å†…å­˜ã€‚æˆ‘ä»¬é€šè¿‡cudaHostAlloc()æ¥åˆ†é…è¿™ç§å†…å­˜ï¼Œå¹¶ä¸”ä¼ é€’å‚æ•°cudaHostAllocDefaultæ¥è·å¾—é»˜è®¤çš„å›ºå®šå†…å­˜ã€‚æœ¬ç« ä¼šä»‹ç»åœ¨åˆ†é…å›ºå®šå†…å­˜æ—¶å¯ä»¥ä½¿ç”¨å…¶ä»–å‚æ•°å€¼ã€‚é™¤äº†cudaHostAllocDefaultå¤–ï¼Œè¿˜å¯ä»¥ä¼ é€’çš„æ ‡å¿—ä¹‹ä¸€æ˜¯cudaHostAllocMappedã€‚é€šè¿‡cudaHostAllocMappedåˆ†é…çš„ä¸»æœºå†…å­˜ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œå®ƒä¸é€šè¿‡cudaHostAllocDefaultåˆ†é…çš„å›ºå®šå†…å­˜æœ‰ç€ç›¸åŒçš„å±æ€§ï¼Œç‰¹åˆ«æ˜¯å½“å®ƒä¸èƒ½ä»ç‰©ç†å†…å­˜ä¸­äº¤æ¢å‡ºå»æˆ–è€…é‡æ–°å®šä½æ—¶ã€‚ä½†è¿™ç§å†…å­˜é™¤äº†å¯ä»¥ç”¨äºä¸»æœºä¸GPUä¹‹é—´çš„å†…å­˜å¤åˆ¶å¤–ï¼Œè¿˜å¯ä»¥æ‰“ç ´ä¸»æœºå†…å­˜è§„åˆ™ä¹‹ä¸€ï¼šå¯ä»¥åœ¨CUDA Cæ ¸å‡½æ•°ä¸­ç›´æ¥è®¿é—®è¿™ç§ç±»å‹çš„ä¸»æœºå†…å­˜ã€‚ç”±äºè¿™ç§å†…å­˜ä¸éœ€è¦å¤åˆ¶åˆ°GPUï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºé›¶æ‹·è´å†…å­˜ã€‚
é€šè¿‡é›¶æ‹·è´å†…å­˜å®ç°ç‚¹ç§¯è¿ç®— é€šå¸¸ï¼ŒGPUåªèƒ½è®¿é—®GPUå†…å­˜ï¼Œè€ŒCPUä¹Ÿåªèƒ½è®¿é—®ä¸»æœºå†…å­˜ã€‚ä½†åœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œæ‰“ç ´è¿™ç§è§„åˆ™æˆ–è®¸èƒ½å¸¦æ¥æ›´å¥½çš„æ•ˆæœã€‚ä¸‹é¢ä»ç„¶ç»™å‡ºä¸€ä¸ªçŸ¢é‡ç‚¹ç§¯è¿ç®—æ¥è¿›è¡Œä»‹ç»ã€‚è¿™ä¸ªç‰ˆæœ¬ä¸å°†è¾“å…¥çŸ¢é‡æ˜¾å¼å¤åˆ¶åˆ°GPUï¼Œè€Œæ˜¯ä½¿ç”¨é›¶æ‹·è´å†…å­˜ä»GPUä¸­ç›´æ¥è®¿é—®æ•°æ®ã€‚æˆ‘ä»¬å°†ç¼–å†™ä¸¤ä¸ªå‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå‡½æ•°æ˜¯å¯¹æ ‡å‡†ä¸»æœºå†…å­˜çš„æµ‹è¯•ï¼Œå¦ä¸€ä¸ªå‡½æ•°å°†åœ¨GPUä¸Šæ‰§è¡Œå½’çº¦è¿ç®—ï¼Œå¹¶ä½¿ç”¨é›¶æ‹·è´å†…å­˜ä½œä¸ºè¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒºã€‚é¦–å…ˆæ˜¯ç‚¹ç§¯è¿ç®—çš„ä¸»æœºå†…å­˜ç‰ˆæœ¬:
float malloc_test(int size){ //é¦–å…ˆåˆ›å»ºè®¡æ—¶äº‹ä»¶ï¼Œç„¶ååˆ†é…è¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒºï¼Œå¹¶ç”¨æ•°æ®å¡«å……è¾“å…¥ç¼“å†²åŒºã€‚ cudaEvent_t start, stop; float *a, *b, c, *partial_c; float *dev_a, *dev_b, *dev_partial_c; float elapsedTime; HANDLE_ERROR(cudaEventCreate(&amp;start)); HANDLE_ERROR(cudaEventCreate(&amp;stop)); //åœ¨CPUä¸Šåˆ†é…å†…å­˜ a = (float*)malloc(size * sizeof(float)); b = (float*)malloc(size * sizeof(float)); partial_c = (float*)malloc(blocksPerGrid * sizeof(float)); //åœ¨GPUä¸Šåˆ†é…å†…å­˜ HANDLE_ERROR(cudaMalloc((void**)&amp;dev_a, size * sizeof(float))); HANDLE_ERROR(cudaMalloc((void**)&amp;dev_b, size * sizeof(float))); HANDLE_ERROR(cudaMalloc((void**)&amp;dev_partial_c, blocksPerGrid * sizeof(float))); //ç”¨æ•°æ®å¡«å……ä¸»æœºå†…å­˜ for(int i = 0; i &lt; size; i++){ a[i] = i; b[i] = i * 2; } //å¯åŠ¨è®¡æ—¶å™¨ï¼Œå°†è¾“å…¥æ•°æ®å¤åˆ¶åˆ°GPUï¼Œæ‰§è¡Œç‚¹ç§¯æ ¸å‡½æ•°ï¼Œå¹¶å°†ä¸­é—´è®¡ç®—ç»“æœå¤åˆ¶å›ä¸»æœºã€‚ HANDLE_ERROR(cudaEventRecord(start, 0)); //å°†æ•°ç»„â€œaâ€œå’Œâ€bâ€å¤åˆ¶åˆ°GPU HANDLE_ERROR(cudaMemcpy(dev_a, a, size * sizeof(float), cudaMemcpyHostToDevice)); HANDLE_ERROR(cudaMemcpy(dev_b, b, size * sizeof(float), cudaMemcpyHostToDevice)); dot&lt;&lt;&lt;blocksPerGrid, threadsPerBlock&gt;&gt;&gt;(size, dev_a, dev_b, dev_partial_c); //å°†æ•°ç»„â€œcâ€ä»GPUå¤åˆ¶åˆ°CPU HANDLE_ERROR(cudaMemcpy(partial_c, dev_partial_c, blocksPerGrid * sizeof(float), cudaMemcpyDeviceToHost)); //åœæ­¢è®¡æ—¶å™¨ HANDLE_ERROR(cudaEventRecord(stop, 0)); HANDLE_ERROR(cudaEventSynchronize(stop)); HANDLE_ERROR(cudaEventElapsedTime(&amp;elapsedTime, start, stop)); //å°†ä¸­é—´è®¡ç®—ç»“æœç›¸åŠ èµ·æ¥ï¼Œå¹¶é‡Šæ”¾è¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒº //ç»“æŸCPUä¸Šçš„è®¡ç®— c = 0; for(int i = 0; i &lt; blocksPerGrid; i++){ c += partial_c[i]; } HANDLE_ERROR(cudaFree(dev_a)); HANDLE_ERROR(cudaFree(dev_b)); HANDLE_ERROR(cudaFree(dev_partial_c)); //é‡Šæ”¾CPUä¸Šçš„å†…å­˜ free(a); free(b); free(partial_c); //é‡Šæ”¾äº‹ä»¶ HANDLE_ERROR(cudaEventDestroy(start)); HANDLE_ERROR(cudaEventDestroy(stop)); printf(&#34;Value calculated: %f\n&#34;, c); return elapsedTime; } ä½¿ç”¨é›¶æ‹·è´å†…å­˜çš„ç‰ˆæœ¬æ˜¯éå¸¸ç±»ä¼¼çš„å¤šï¼Œåªæ˜¯åœ¨å†…å­˜åˆ†é…ä¸Šæœ‰æ‰€ä¸åŒï¼š]]></description></item><item><title>CUDAå­¦ä¹ (ä¸ƒ)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%83/</link><pubDate>Wed, 28 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%83/</guid><description><![CDATA[åœ¨å¹¶è¡Œç¯å¢ƒä¸­ï¼Œä»»åŠ¡å¯ä»¥æ˜¯ä»»æ„æ“ä½œã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ‰§è¡Œä¸¤ä¸ªä»»åŠ¡ï¼šå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹é‡ç»˜ç¨‹åºçš„GUIï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹é€šè¿‡ç½‘ç»œä¸‹è½½æ›´æ–°åŒ…ã€‚è¿™äº›ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œå½¼æ­¤ä¹‹é—´æ²¡æœ‰ä»»ä½•å…±åŒçš„åœ°æ–¹ã€‚è™½ç„¶GPUä¸Šçš„ä»»åŠ¡å¹¶è¡Œæ€§å¹¶ä¸åƒCPUä¸Šçš„ä»»åŠ¡å¹¶è¡Œæ€§é‚£æ ·çµæ´»ï¼Œä½†ä»ç„¶å¯ä»¥è¿›ä¸€æ­¥æé«˜ç¨‹åºåœ¨GPUä¸Šçš„è¿è¡Œé€Ÿåº¦ã€‚æœ¬ç« å°†ä»‹ç»CUDAæµï¼Œä»¥åŠå¦‚ä½•é€šè¿‡æµåœ¨GPUä¸ŠåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚
é¡µé”å®š(Page-Locked)ä¸»æœºå†…å­˜ CUDAæä¾›äº†è‡ªå·±ç‹¬æœ‰çš„æœºåˆ¶æ¥åˆ†é…ä¸»æœºå†…å­˜ï¼šcudaHostAlloc()ã€‚malloc()åˆ†é…çš„å†…å­˜ä¸cudaHostAlloc()åˆ†é…çš„å†…å­˜ä¹‹é—´å­˜åœ¨ä¸€ä¸ªé‡è¦å·®å¼‚ã€‚Cåº“å‡½æ•°malloc()å°†åˆ†é…æ ‡å‡†çš„ã€å¯åˆ†é¡µçš„(Pagable)ä¸»æœºå†…å­˜ï¼Œè€ŒcudaHostAlloc()å°†åˆ†é…é¡µé”å®šçš„ä¸»æœºå†…å­˜ã€‚é¡µé”å®šå†…å­˜ä¹Ÿç§°ä¸ºå›ºå®šå†…å­˜(Pinned Memory)æˆ–è€…ä¸å¯åˆ†é¡µå†…å­˜ï¼Œå®ƒæœ‰ä¸€ä¸ªé‡è¦å±æ€§ï¼šæ“ä½œç³»ç»Ÿå°†ä¸ä¼šå¯¹è¿™å—å†…å­˜åˆ†é¡µå¹¶äº¤è¿˜åˆ°ç£ç›˜ä¸Šï¼Œä»è€Œç¡®ä¿äº†è¯¥å†…å­˜å§‹ç»ˆé©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿèƒ½å¤Ÿå®‰å…¨åœ°ä½¿æŸä¸ªåº”ç”¨ç¨‹åºè®¿é—®è¯¥å†…å­˜çš„ç‰©ç†åœ°å€ï¼Œå› ä¸ºè¿™å—å†…å­˜å°†ä¸ä¼šè¢«ç ´åæˆ–è€…é‡æ–°å®šä½ã€‚
ç”±äºGPUçŸ¥é“å†…å­˜çš„ç‰©ç†åœ°å€ï¼Œå› æ­¤å¯ä»¥é€šè¿‡â€œç›´æ¥å†…å­˜è®¿é—®ï¼ˆDirect Memory Accessï¼ŒDMAï¼‰â€æŠ€æœ¯æ¥åœ¨GPUå’Œä¸»æœºä¹‹é—´å¤åˆ¶æ•°æ®ã€‚ç”±äºDMAåœ¨æ‰§è¡Œå¤åˆ¶æ—¶æ— éœ€CPUçš„ä»‹å…¥ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼ŒCPUå¾ˆå¯èƒ½åœ¨DMAçš„æ‰§è¡Œè¿‡ç¨‹ä¸­å°†ç›®æ ‡å†…å­˜äº¤æ¢åˆ°ç£ç›˜ä¸Šï¼Œæˆ–è€…é€šè¿‡æ›´æ–°æ“ä½œç³»ç»Ÿçš„åˆ†é¡µæ¥é‡æ–°å®šä½ç›®æ ‡å†…å­˜çš„ç‰©ç†åœ°å€ã€‚CPUå¯èƒ½ä¼šç§»åŠ¨å¯åˆ†é¡µçš„æ•°æ®ï¼Œè¿™å°±å¯èƒ½å¯¹DMAæ“ä½œé€ æˆå»¶è¿Ÿã€‚å› æ­¤ï¼Œåœ¨DMAå¤åˆ¶è¿‡ç¨‹ä¸­ä½¿ç”¨å›ºå®šå†…å­˜æ—¶éå¸¸é‡è¦çš„ã€‚
äº‹å®ä¸Šï¼Œå½“ä½¿ç”¨å¯åˆ†é¡µå†…å­˜è¿›è¡Œå¤åˆ¶æ—¶ï¼ŒCUDAé©±åŠ¨ç¨‹åºä»ç„¶ä¼šé€šè¿‡DAMæŠŠæ•°æ®ä¼ è¾“ç»™GPUã€‚å› æ­¤ï¼Œå¤åˆ¶æ“ä½œå°†æ‰§è¡Œä¸¤éï¼Œç¬¬ä¸€éä»å¯åˆ†é¡µå†…å­˜å¤åˆ¶åˆ°ä¸€å—â€œä¸´æ—¶çš„â€é¡µé”å®šå†…å­˜ï¼Œç„¶åå†ä»è¿™ä¸ªé¡µé”å®šå†…å­˜å¤åˆ¶åˆ°GPUä¸Šã€‚å› æ­¤ï¼Œ**æ¯å½“ä»å¯åˆ†é¡µå†…å­˜ä¸­æ‰§è¡Œå¤åˆ¶æ“ä½œæ—¶ï¼Œå¤åˆ¶é€Ÿåº¦å°†å—é™äºPCIEï¼ˆé«˜é€Ÿä¸²è¡Œè®¡ç®—æœºæ‰©å±•æ€»çº¿æ ‡å‡†ï¼‰ä¼ è¾“é€Ÿåº¦å’Œç³»ç»Ÿå‰ç«¯æ€»çº¿é€Ÿåº¦ç›¸å¯¹è¾ƒä½çš„ä¸€æ–¹ã€‚å½“åœ¨GPUå’Œä¸»æœºé—´å¤åˆ¶æ•°æ®æ—¶ï¼Œè¿™ç§å·®å¼‚ä¼šä½¿é¡µé”å®šä¸»æœºå†…å­˜çš„æ€§èƒ½æ¯”æ ‡å‡†å¯åˆ†é¡µå†…å­˜çš„æ€§èƒ½è¦é«˜è¾¾çº¦2å€ã€‚**è®¡æ—¶PCIEçš„é€Ÿåº¦ä¸å‰ç«¯æ€»çº¿çš„é€Ÿåº¦ç›¸ç­‰ï¼Œç”±äºå¯åˆ†é¡µå†…å­˜éœ€è¦æ›´å¤šä¸€æ¬¡ç”±CPUå‚ä¸çš„å¤åˆ¶æ“ä½œï¼Œå› æ­¤ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚
ç„¶è€Œï¼Œä½¿ç”¨cudaHostAlloc()åˆ†é…å›ºå®šå†…å­˜æ—¶ï¼Œå°†å¤±å»è™šæ‹Ÿå†…å­˜çš„æ‰€æœ‰åŠŸèƒ½ã€‚ç‰¹åˆ«æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ¯ä¸ªé¡µé”å®šå†…å­˜æ—¶éƒ½éœ€è¦åˆ†é…ç‰©ç†å†…å­˜ï¼Œå› ä¸ºè¿™äº›å†…å­˜ä¸èƒ½äº¤æ¢åˆ°ç£ç›˜ä¸Šã€‚è¿™æ„å‘³ç€ä¸ä½¿ç”¨æ ‡å‡†çš„malloc()è°ƒç”¨ç›¸æ¯”ï¼Œç³»ç»Ÿå°†æ›´å¿«åœ°è€—å°½å†…å­˜ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºåœ¨ç‰©ç†å†…å­˜è¾ƒå°‘çš„æœºå™¨ä¸Šä¼šè¿è¡Œå¤±è´¥ï¼Œè€Œä¸”æ„å‘³ç€åº”ç”¨ç¨‹åºå°†å½±å“åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„å…¶ä»–åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚å»ºè®®ä»…å¯¹cudaMemcpy()è°ƒç”¨ä¸­çš„æºå†…å­˜æˆ–è€…ç›®æ ‡å†…å­˜æ‰ä½¿ç”¨é¡µé”å®šå†…å­˜ï¼Œå¹¶ä¸”åœ¨ä¸å†éœ€è¦ä½¿ç”¨å®ƒä»¬æ—¶ç«‹å³é‡Šæ”¾ï¼Œè€Œä¸æ˜¯ç­‰åˆ°åº”ç”¨ç¨‹åºå…³é—­æ—¶æ‰é‡Šæ”¾ã€‚
ä¸‹é¢ç»™çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•åˆ†é…å›ºå®šå†…å­˜ï¼Œä»¥åŠå®ƒç›¸å¯¹äºæ ‡å‡†å¯åˆ†é¡µå†…å­˜çš„æ€§èƒ½ä¼˜åŠ¿ã€‚è¿™ä¸ªä¾‹å­ä¸»è¦æ˜¯æµ‹è¯•cudaMemcpy()åœ¨å¯åˆ†é…å†…å­˜å’Œé¡µé”å®šå†…å­˜ä¸Šçš„æ€§èƒ½ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆ†é…ä¸€ä¸ªGPUç¼“å†²åŒºä»¥åŠä¸€ä¸ªå¤§å°ç›¸ç­‰çš„ä¸»æœºç¼“å†²åŒºï¼Œç„¶åä¸¤ä¸ªç¼“å†²åŒºä¹‹é—´æ‰§è¡Œä¸€äº›å¤åˆ¶æ“ä½œï¼ˆä»ä¸»æœºåˆ°è®¾å¤‡ã€ä»è®¾å¤‡åˆ°ä¸»æœºï¼‰ã€‚ä¸ºäº†è·å¾—ç²¾ç¡®çš„æ—¶é—´ç»Ÿè®¡ï¼Œæˆ‘ä»¬ä¸ºå¤åˆ¶æ“ä½œçš„èµ·å§‹æ—¶åˆ»å’Œç»“æŸæ—¶åˆ»åˆ†åˆ«è®¾ç½®äº†CUDAäº‹ä»¶ã€‚
float cuda_malloc_test(int size, bool up){ cudaEvent_t start, stop; int *a, *dev_a; float elapsedTime; HANDLE_ERROR(cudaEventCreate(&amp;start)); HANDLE_ERROR(cudaEventCreate(&amp;stop)); a = (int*)malloc(size * sizeof(*a)); HANDLE_NULL(a); HANDLE_ERROR(cudaMalloc((void**)&amp;dev_a, size * sizeof(&amp;dev_a))); HANDLE_ERROR(cuddaEventRecord(start, 0)); //ä¸ºsizeä¸ªæ•´æ•°åˆ†åˆ«åˆ†é…ä¸»æœºç¼“å†²åŒºå’ŒGPUç¼“å†²åŒºï¼Œç„¶åæ‰§è¡Œ100æ¬¡å¤åˆ¶æ“ä½œï¼Œå¹¶ç”±å‚æ•°upæ¥æŒ‡å®šå¤åˆ¶æ–¹å‘ï¼Œåœ¨å®Œæˆå¤åˆ¶æ“ä½œååœæ­¢è®¡æ—¶å™¨ for(int i = 0; i &lt; 100; i++){ if(up){ HANDLE_ERROR(cudaMemcpy(dev_a, a, size * sizeof(*dev_a), cudaMemcpyHostToDevice)); } else{ HANDLE_ERROR(cudaMemcpy(a, dev_a, size * sizeof(*dev_a), cudaMemcpyDeviceToHost)); } } HANDLE_ERROR(cudaEventRecord(stop, 0)); HANDLE_ERROR(cudaEventSynchronize(stop)); HANDLE_ERROR(cudaEventElapsedTime(&amp;elapsedTime, start, stop)); free(a); HANDLE_ERROR(cudaFree(dev_a)); HANDLE_ERROR(cudaEventDestroy(start)); HANDLE_ERROR(cudaEventDestroy(stop)); return elapsedTime; } å‡½æ•°cuda_malloc_test()é€šè¿‡æ ‡å‡†çš„Cå‡½æ•°malloc()æ¥åˆ†é…å¯åˆ†é¡µä¸»æœºå†…å­˜ï¼Œåœ¨åˆ†é…å›ºå®šå†…å­˜æ—¶åˆ™ä½¿ç”¨äº†cudaHostAlloc()ã€‚]]></description></item><item><title>CUDAå­¦ä¹ (å…­)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%85%AD/</link><pubDate>Tue, 27 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%85%AD/</guid><description><![CDATA[åœ¨æŸäº›æƒ…å†µä¸­ï¼Œå¯¹äºå•çº¿ç¨‹åº”ç”¨ç¨‹åºæ¥è¯´éå¸¸ç®€å•çš„ä»»åŠ¡ï¼Œåœ¨å¤§è§„æ¨¡å¹¶è¡Œæ¶æ„ä¸Šå®ç°æ—¶ä¼šå˜æˆä¸€ä¸ªå¤æ‚çš„é—®é¢˜ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¸¾ä¾‹å…¶ä¸­ä¸€äº›æƒ…å†µï¼Œå¹¶åœ¨è¿™äº›æƒ…å†µä¸­å®‰å…¨åœ°å®Œæˆä¼ ç»Ÿå•çº¿ç¨‹åº”ç”¨ç¨‹åºä¸­çš„ç®€å•ä»»åŠ¡ã€‚
åŸå­æ“ä½œç®€ä»‹ åœ¨ç¼–å†™ä¼ ç»Ÿçš„å•çº¿ç¨‹åº”ç”¨ç¨‹åºæ—¶ï¼Œç¨‹åºå‘˜é€šå¸¸ä¸éœ€è¦ä½¿ç”¨åŸå­æ“ä½œã€‚ä¸‹é¢ä¼šä»‹ç»ä¸€ä¸‹åŸå­æ“ä½œæ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­éœ€è¦ä½¿ç”¨å®ƒä»¬ã€‚æˆ‘ä»¬å…ˆåˆ†æCæˆ–è€…C++çš„é€’å¢è¿ç®—ç¬¦ï¼š
x++;
åœ¨è¿™ä¸ªæ“ä½œä¸­åŒ…å«äº†ä¸‰ä¸ªæ­¥éª¤ï¼š
è¯»å–xä¸­çš„å€¼ã€‚ å°†æ­¥éª¤1ä¸­è¯»åˆ°çš„å€¼å¢åŠ 1ã€‚ å°†é€’å¢åçš„ç»“æœå†™å›åˆ°xã€‚ æœ‰æ—¶å€™ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿç§°ä¸ºè¯»å–-ä¿®æ”¹-å†™å…¥æ“ä½œã€‚
å½“ä¸¤ä¸ªçº¿ç¨‹éƒ½éœ€è¦å¯¹xçš„å€¼è¿›è¡Œé€’å¢æ—¶ï¼Œå‡è®¾xçš„åˆå§‹å€¼ä¸º7ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªçº¿ç¨‹æŒ‰é¡ºåºå¯¹xè¿›è¡Œé€’å¢ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹å®Œæˆä¸‰ä¸ªæ­¥éª¤åç¬¬äºŒä¸ªçº¿ç¨‹ç´§æ¥ç€å®Œæˆä¸‰ä¸ªæ­¥éª¤ï¼Œæœ€åå¾—åˆ°çš„ç»“æœæ˜¯9ã€‚ä½†æ˜¯ï¼Œå®é™…æƒ…å†µä¸‹ä¼šå‡ºç°ä¸¤ä¸ªçº¿ç¨‹çš„æ“ä½œå½¼æ­¤äº¤å‰è¿›è¡Œï¼Œè¿™ç§æƒ…å†µä¸‹å¾—åˆ°çš„ç»“æœå°†å°äº9(æ¯”å¦‚ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¯»å–x=7ï¼Œè®¡ç®—å®Œåå†™å…¥ï¼Œé‚£æ ·çš„è¯xæœ€åä¼šç­‰äº8)ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æŸç§æ–¹å¼ä¸€æ¬¡æ€§åœ°æ‰§è¡Œå®Œè¯»å–-ä¿®æ”¹-å†™å…¥è¿™ä¸‰ä¸ªæ“ä½œï¼Œå¹¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ã€‚ç”±äºè¿™äº›æ“ä½œçš„æ‰§è¡Œè¿‡ç¨‹ä¸èƒ½åˆ†è§£ä¸ºæ›´å°çš„éƒ¨åˆ†ï¼Œå› æ­¤æˆ‘ä»¬å°†æ»¡è¶³è¿™ç§æ¡ä»¶é™åˆ¶çš„æ“ä½œç§°ä¸ºåŸå­æ“ä½œã€‚
è®¡ç®—ç›´æ–¹å›¾ æœ¬ç« å°†é€šè¿‡ç»™å‡ºè®¡ç®—ç›´æ–¹å›¾çš„ä¾‹å­æ¥ä»‹ç»å¦‚ä½•è¿›è¡ŒåŸå­æ€§è®¡ç®—ã€‚
åœ¨CPUä¸Šè®¡ç®—ç›´æ–¹å›¾ æŸä¸ªæ•°æ®çš„ç›´æ–¹å›¾è¡¨ç¤ºæ¯ä¸ªå…ƒç´ å‡ºç°çš„é¢‘ç‡ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œè¿™ä¸ªæ•°æ®å°†æ˜¯éšæœºç”Ÿæˆçš„å­—èŠ‚æµã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å·¥å…·å‡½æ•°big_random_block()æ¥ç”Ÿæˆè¿™ä¸ªéšæœºçš„å­—èŠ‚æµã€‚åœ¨åº”ç”¨ç¨‹åºä¸­å°†ç”Ÿæˆ100MBçš„éšæœºæ•°æ®ã€‚
#include &#34;../common/book.h&#34; #define SIZE (100 * 1024 * 1024) int main(){ unsigned char *buffer = (unsigned char*)big_random_block(SIZE); } ç”±äºæ¯ä¸ªéšæœºå­—èŠ‚ï¼ˆ8æ¯”ç‰¹ï¼‰éƒ½æœ‰256ä¸ªä¸åŒçš„å¯èƒ½å–å€¼ï¼ˆä»0x00åˆ°0xFFï¼‰ï¼Œå› æ­¤åœ¨ç›´æ–¹å›¾ä¸­éœ€è¦åŒ…å«256ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ è®°å½•ç›¸åº”çš„å€¼åœ¨æ•°æ®æµä¸­çš„å‡ºç°æ¬¡æ•°ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«256ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ çš„å€¼åˆå§‹åŒ–ä¸º0ã€‚
unsigned int histo[256]; for(int i = 0; i &lt; 256; i++){ histo[i] = 0; } æ¥ä¸‹æ¥éœ€è¦è®¡ç®—æ¯ä¸ªå€¼åœ¨buffer[]æ•°æ®ä¸­çš„å‡ºç°é¢‘ç‡ã€‚ç®—æ³•æ€æƒ³æ˜¯ï¼Œæ¯å½“åœ¨æ•°ç»„buffer[]ä¸­å‡ºç°æŸä¸ªå€¼zæ—¶ï¼Œå°±é€’å¢ç›´æ–¹å›¾æ•°ç»„ä¸­ç´¢å¼•ä¸ºzçš„å…ƒç´ ï¼Œè¿™æ ·å°±èƒ½è®¡ç®—å‡ºå€¼zçš„å‡ºç°æ¬¡æ•°ã€‚å¦‚æœå½“å‰çœ‹åˆ°çš„å€¼ä¸ºbuffer[i]ï¼Œé‚£ä¹ˆå°†é€’å¢æ•°ç»„ä¸­ç´¢å¼•ç­‰äºbuffer[i]çš„å…ƒç´ ã€‚ç”±äºå…ƒç´ buffer[i]ä½äºhisto[buffer[i]]ï¼Œæˆ‘ä»¬åªéœ€ä¸€è¡Œä»£ç å°±å¯ä»¥é€’å¢ç›¸åº”çš„è®¡æ•°å™¨ã€‚åœ¨ä¸€ä¸ªforå¾ªç¯ä¸­å¯¹buffer[]ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œè¿™ä¸ªæ“ä½œï¼š
for(int i = 0; i &lt; SIZE; i++){ histo[buffer[i]]++; } æ¥ä¸‹æ¥å°†éªŒè¯ç›´æ–¹å›¾çš„æ‰€æœ‰å…ƒç´ ç›¸åŠ èµ·æ¥æ˜¯å¦ç­‰äºæ­£ç¡®çš„å€¼ã€‚
long histoCount = 0; for(int i = 0; i &lt; 256; i++){ histoCount += histo[i]; } printf(&#34;Histogram Sum: %ld\n&#34;, histoCount); free(buffer); åœ¨GPUä¸Šè®¡ç®—ç›´æ–¹å›¾ ä»¥ä¸‹æ—¶è®¡ç®—ç›´æ–¹å›¾çš„GPUç‰ˆæœ¬]]></description></item><item><title>CUDAå­¦ä¹ (äº”)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%BA%94/</link><pubDate>Fri, 23 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%BA%94/</guid><description>æœ¬ç« å°†å­¦ä¹ å¦‚ä½•åˆ†é…å’Œä½¿ç”¨çº¹ç†å†…å­˜(texture memory)ã€‚å’Œå¸¸é‡å†…å­˜ä¸€æ ·ï¼Œçº¹ç†å†…å­˜æ˜¯å¦ä¸€ç§ç±»å‹çš„åªè¯»å†…å­˜ï¼Œåœ¨ç‰¹å®šçš„è®¿é—®æ¨¡å¼ä¸­ï¼Œçº¹ç†å†…å­˜åŒæ ·èƒ½å¤Ÿæå‡æ€§èƒ½å¹¶å‡å°‘å†…å­˜æµé‡ã€‚è™½ç„¶çº¹ç†å†…å­˜æœ€åˆæ˜¯é’ˆå¯¹ä¼ ç»Ÿçš„å›¾å½¢å¤„ç†åº”ç”¨ç¨‹åºè€Œè®¾è®¡çš„ï¼Œä½†åœ¨æŸäº›GPUè®¡ç®—åº”ç”¨ç¨‹åºä¸­åŒæ ·éå¸¸æœ‰ç”¨ã€‚
ä¸å¸¸é‡å†…å­˜ç›¸ä¼¼çš„æ˜¯ï¼Œçº¹ç†å†…å­˜åŒæ ·ç¼“å­˜åœ¨èŠ¯ç‰‡ä¸Šï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸­ï¼Œå®ƒèƒ½å¤Ÿå‡å°‘å¯¹å†…å­˜è¯·æ±‚å¹¶æä¾›æ›´é«˜æ•ˆçš„å†…å­˜å¸¦å®½ã€‚çº¹ç†ç¼“å­˜æ˜¯ä¸“é—¨ä¸ºé‚£äº›åœ¨å†…å­˜è®¿é—®æ¨¡å¼ä¸­å­˜åœ¨å¤§é‡ç©ºé—´å±€éƒ¨æ€§(spatial locality)çš„å›¾å½¢åº”ç”¨ç¨‹åºè€Œè®¾è®¡çš„ã€‚åœ¨æŸä¸ªè®¡ç®—åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªçº¿ç¨‹è¯»å–çš„ä½ç½®å¯èƒ½ä¸é‚»è¿‘çº¿ç¨‹è¯»å–çš„ä½ç½®â€œéå¸¸æ¥è¿‘â€ã€‚
çƒ­ä¼ å¯¼æ¨¡æ‹Ÿ æœ¬ç« ç”¨ä¸€ä¸ªç®€å•çš„çƒ­ä¼ å¯¼æ¨¡æ‹Ÿçš„æ¨¡å‹æ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨çº¹ç†å†…å­˜ã€‚
ç®€å•çš„ä¼ çƒ­æ¨¡å‹ æˆ‘ä»¬æ„é€ ä¸€ä¸ªç®€å•çš„äºŒç»´çƒ­ä¼ å¯¼æ¨¡æ‹Ÿã€‚é¦–å…ˆå‡è®¾æœ‰ä¸€ä¸ªçŸ©å½¢æˆ¿é—´ï¼Œå°†å…¶åˆ†æˆä¸€ä¸ªæ ¼ç½‘ï¼Œæ¯ä¸ªæ ¼ç½‘ä¸­éšæœºæ•£æ­¥ä¸€äº›â€œçƒ­æºâ€ï¼Œä»–ä»¬æœ‰ç€ä¸åŒçš„æ¸©åº¦ã€‚
åœ¨ç»™å®šäº†çŸ©å½¢æ ¼ç½‘ä»¥åŠçƒ­æºåˆ†å¸ƒåï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ ¼ç½‘ä¸­æ¯ä¸ªå•å…ƒæ ¼çš„æ¸©åº¦éšæ—¶é—´çš„å˜åŒ–æƒ…å†µã€‚ä¸ºäº†ç®€å•ï¼Œçƒ­æºå•å…ƒæœ¬èº«çš„æ¸©åº¦å°†ä¿æŒä¸å˜ã€‚åœ¨æ—¶é—´é€’è¿›çš„æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å‡è®¾çƒ­é‡åœ¨æŸä¸ªå•å…ƒåŠå…¶é‚»æ¥å•å…ƒä¹‹é—´â€œæµåŠ¨â€ã€‚å¦‚æœæŸä¸ªå•å…ƒçš„ä¸´ç•Œå•å…ƒçš„æ¸©åº¦æ›´é«˜ï¼Œé‚£ä¹ˆçƒ­é‡å°†ä»é‚»æ¥å•å…ƒä¼ å¯¼åˆ°è¯¥å•å…ƒï¼Œç›¸ååœ°ï¼Œå¦‚æœæŸä¸ªå•å…ƒçš„æ¸©åº¦æ¯”é‚»æ¥å•å…ƒçš„æ¸©åº¦é«˜ï¼Œé‚£ä¹ˆå®ƒå°†å˜å†·ã€‚
åœ¨çƒ­ä¼ å¯¼æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å¯¹å•å…ƒä¸­æ–°æ¸©åº¦çš„è®¡ç®—æ–¹æ³•ä¸ºï¼Œå°†å•å…ƒä¸é‚»æ¥å•å…ƒçš„æ¸©å·®ç›¸åŠ èµ·æ¥ï¼Œç„¶ååŠ ä¸ŠåŸæœ‰æ¸©åº¦ã€‚ $$ T_{NEW} = T_{OLD} + \sum_{NEIGHBOURS}k(T_{NEIGHBORS} - T_{OLD}) $$ åœ¨ä¸Šé¢çš„è®¡ç®—å•å…ƒæ¸©åº¦çš„ç­‰å¼ä¸­ï¼Œå¸¸é‡kè¡¨ç¤ºæ¨¡æ‹Ÿè¿‡ç¨‹ä¸­çƒ­é‡çš„æµåŠ¨é€Ÿç‡ï¼Œkå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºç³»ç»Ÿä¼šæ›´å¿«åœ°è¾¾åˆ°ç¨³å®šæ¸©åº¦ï¼Œè€Œkå€¼è¶Šå°ï¼Œåˆ™æ¸©åº¦æ¢¯åº¦å°†å­˜åœ¨æ›´é•¿æ—¶é—´ã€‚ç”±äºæˆ‘ä»¬åªè€ƒè™‘4ä¸ªé‚»æ¥å•å…ƒ(ä¸Šã€ä¸‹ã€å·¦ã€å³)å¹¶ä¸”ç­‰å¼ä¸­çš„kå’Œ$$T_{OLD}$$éƒ½æ˜¯å¸¸æ•°ï¼Œå› æ­¤æŠŠä¸Šè¿°å…¬å¼å±•å¼€è¡¨ç¤ºä¸º: $$ T_{NEW} = T_{OLD} + k(T_{TOP} + T_{BOTTOM} + T_{LEFT} + T_{RIGHT} - 4T_{OLD}) $$
æ¸©åº¦æ›´æ–°çš„è®¡ç®— ä»¥ä¸‹æ˜¯æ›´æ–°æµç¨‹çš„åŸºæœ¬ä»‹ç»:
ç»™å®šä¸€ä¸ªåŒ…å«åˆå§‹è¾“å…¥æ¸©åº¦çš„æ ¼ç½‘ï¼Œå°†å…¶ä¸­ä½œä¸ºçƒ­æºçš„å•å…ƒæ¸©åº¦å€¼å¤åˆ¶åˆ°æ ¼ç½‘ç›¸åº”çš„å•å…ƒä¸­æ¥è¦†ç›–è¿™äº›å•å…ƒä¹‹å‰è®¡ç®—å‡ºæ¥çš„æ¸©åº¦ï¼Œç¡®ä¿â€œåŠ çƒ­å•å…ƒå°†ä¿æŒæ’æ¸©â€çš„æ¡ä»¶ã€‚è¿™ä¸ªå¤åˆ¶æ“ä½œåœ¨copy_const_kernel()ä¸­æ‰§è¡Œã€‚ ç»™å®šä¸€ä¸ªè¾“å…¥æ¸©åº¦æ ¼ç½‘ï¼Œæ ¹æ®æ–°çš„å…¬å¼è®¡ç®—å‡ºè¾“å‡ºæ¸©åº¦æ ¼ç½‘ã€‚è¿™ä¸ªæ›´æ–°æ“ä½œåœ¨blend_kernel()ä¸­æ‰§è¡Œã€‚ å°†è¾“å…¥æ¸©åº¦æ ¼ç½‘å’Œè¾“å‡ºæ¸©åº¦æ ¼ç½‘äº¤æ¢ï¼Œä¸ºä¸‹ä¸€ä¸ªæ­¥éª¤çš„è®¡ç®—åšå¥½å‡†å¤‡ã€‚å½“æ¨¡æ‹Ÿä¸‹ä¸€ä¸ªæ—¶é—´æ­¥æ—¶ï¼Œåœ¨æ­¥éª¤2ä¸­è®¡ç®—å¾—åˆ°çš„è¾“å‡ºæ¸©åº¦æ ¼ç½‘å°†æˆä¸ºæ­¥éª¤1ä¸­çš„è¾“å…¥æ¸©åº¦æ ¼ç½‘ã€‚ ä¸‹é¢æ˜¯ä¸¤ä¸ªå‡½æ•°çš„å…·ä½“å®ç°:
__global__ void copy_const_kernel(float *iptr, const float *cptr){ //å°†threadIdx/BlockIdxæ˜ å°„åˆ°åƒç´ ä½ç½® int x = threadIdx.x + blockIdx.x * blockDim.x; int y = threadIdx.y + blockIdx.y * blockDim.y; int offset = x + y * blockDim.</description></item><item><title>CUDAå­¦ä¹ (å››)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%9B%9B/</link><pubDate>Sun, 18 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E5%9B%9B/</guid><description>è¿™ä¸€ç« ä¼šä»‹ç»å¦‚ä½•åœ¨CUDA Cä¸­ä½¿ç”¨å¸¸é‡å†…å­˜ã€äº†è§£å¸¸é‡å†…å­˜çš„æ€§èƒ½ç‰¹æ€§ä»¥åŠå­¦ä¹ å¦‚ä½•ä½¿ç”¨CUDAäº‹ä»¶æ¥æµ‹é‡åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚
å¸¸é‡å†…å­˜ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çŸ¥é“CUDA Cç¨‹åºä¸­å¯ä»¥ä½¿ç”¨å…¨å±€å†…å­˜å’Œå…±äº«å†…å­˜ã€‚ä½†æ˜¯ï¼ŒCUDA Cè¿˜æ”¯æŒå¦ä¸€ç§ç±»å‹çš„å†…å­˜ï¼Œå³å¸¸é‡å†…å­˜ã€‚å¸¸é‡å†…å­˜ç”¨äºä¿å­˜åœ¨æ ¸å‡½æ•°æ‰§è¡ŒæœŸé—´ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„æ•°æ®ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”¨å¸¸é‡å†…å­˜æ¥æ›¿æ¢å…¨å±€å†…å­˜èƒ½æœ‰æ•ˆåœ°å‡å°‘å†…å­˜å¸¦å®½ã€‚
åœ¨GPUä¸Šå®ç°å…‰çº¿è·Ÿè¸ª æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç®€å•çš„å…‰çº¿è·Ÿè¸ªåº”ç”¨ç¨‹åºç¤ºä¾‹æ¥å­¦ä¹ ã€‚ç”±äºOpenGLå’ŒDirectXç­‰APIéƒ½ä¸æ˜¯ä¸“é—¨ä¸ºäº†å®ç°å…‰çº¿è·Ÿè¸ªè€Œè®¾è®¡çš„ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ä½¿ç”¨CUDA Cæ¥å®ç°åŸºæœ¬çš„å…‰çº¿è·Ÿè¸ªå™¨ã€‚æœ¬ç¤ºä¾‹æ„é€ çš„å…‰çº¿è·Ÿè¸ªå™¨éå¸¸ç®€å•ï¼Œæ—¨åœ¨å­¦ä¹ å¸¸é‡å†…å­˜çš„ä½¿ç”¨ä¸Š(å¹¶ä¸èƒ½é€šè¿‡ç¤ºä¾‹ä»£ç æ¥æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„æ¸²æŸ“å™¨)ã€‚è¿™ä¸ªå…‰çº¿è·Ÿè¸ªå™¨åªæ”¯æŒä¸€ç»„åŒ…å«çƒçŠ¶ç‰©ä½“çš„åœºæ™¯ï¼Œå¹¶ä¸”ç›¸æœºè¢«å›ºå®šåœ¨äº†Zè½´ï¼Œé¢å‘åŸç‚¹ã€‚æ­¤å¤–ï¼Œç¤ºä¾‹ä»£ç ä¹Ÿä¸æ”¯æŒåœºæ™¯ä¸­çš„ä»»ä½•ç…§æ˜ï¼Œä»è€Œé¿å…äºŒæ¬¡å…‰çº¿å¸¦æ¥çš„å¤æ‚æ€§ã€‚ä»£ç ä¹Ÿä¸è®¡ç®—ç…§æ˜æ•ˆæœï¼Œè€Œåªæ˜¯ä¸ºæ¯ä¸ªçƒé¢åˆ†é…ä¸€ä¸ªé¢œè‰²å€¼ï¼Œå¦‚æœå®ƒä»¬æ˜¯å¯è§çš„ï¼Œåˆ™é€šè¿‡æŸä¸ªé¢„å…ˆè®¡ç®—çš„å€¼å¯¹å…¶ç€è‰²ã€‚
å…‰çº¿è·Ÿè¸ªå™¨å°†ä»æ¯ä¸ªåƒç´ å‘å°„ä¸€é“å…‰çº¿ï¼Œå¹¶ä¸”è·Ÿè¸ªåˆ°è¿™äº›å…‰çº¿ä¼šå‘½ä¸­å“ªäº›çƒé¢ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å°†è·Ÿè¸ªæ¯é“å‘½ä¸­å…‰çº¿çš„æ·±åº¦ã€‚å½“ä¸€é“å…‰çº¿ç©¿è¿‡å¤šä¸ªçƒé¢æ—¶ï¼Œåªæœ‰æœ€æ¥è¿‘ç›¸æœºçš„çƒé¢æ‰ä¼šè¢«çœ‹åˆ°ã€‚è¿™ä¸ªä»£ç çš„å…‰çº¿è·Ÿè¸ªå™¨ä¼šæŠŠç›¸æœºçœ‹ä¸åˆ°çš„çƒé¢éšè—èµ·æ¥ã€‚
é€šè¿‡ä¸€ä¸ªæ•°æ®ç»“æ„å¯¹çƒé¢å»ºæ¨¡ï¼Œåœ¨æ•°æ®ç»“æ„ä¸­åŒ…å«äº†çƒé¢çš„ä¸­å¿ƒåæ ‡(x, y, z)ï¼ŒåŠå¾„radiusï¼Œä»¥åŠé¢œè‰²å€¼(r, g, b)ã€‚
#define INF 2e10f struct sphere{ float r, g, b; float radius; float x, y, z; __device__ float hit(float ox, float oy, float *n){ float dx = ox - x; float dy = oy - y; if(dx * dx + dy * dy &amp;lt; radius * radius){ float dz = sqrtf(radius * radius - dx * dx - dy * dy); *n = dz / sqrtf(radius * radius); return dz + z; } return -INF; } } è¿™ä¸ªç»“æ„ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•hit(float ox, float oy, float *n)ã€‚å¯¹äºæ¥è‡ª(ox, oy)å¤„åƒç´ çš„å…‰çº¿ï¼Œè¿™ä¸ªæ–¹æ³•å°†è®¡ç®—å…‰çº¿æ˜¯å¦ä¸è¿™ä¸ªçƒé¢ç›¸äº¤ã€‚å¦‚æœå…‰çº¿ä¸çƒé¢ç›¸äº¤ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°†è®¡ç®—ä»ç›¸æœºåˆ°å…‰çº¿å‘½ä¸­çƒé¢å¤„çš„è·ç¦»ã€‚æˆ‘ä»¬éœ€è¦è¿™ä¸ªä¿¡æ¯ï¼Œå› ä¸ºå½“å…‰çº¿å‘½ä¸­å¤šä¸ªçƒé¢æ—¶ï¼Œåªæœ‰æœ€æ¥è¿‘ç›¸æœºçš„çƒé¢æ‰ä¼šè¢«çœ‹è§ã€‚</description></item><item><title>CUDAå­¦ä¹ (ä¸‰)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%89/</link><pubDate>Mon, 12 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%89/</guid><description><![CDATA[è¿™ä¸€ç« å°†ä»‹ç»çº¿ç¨‹å—ä»¥åŠçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æœºåˆ¶å’ŒåŒæ­¥æœºåˆ¶ã€‚
åœ¨GPUå¯åŠ¨å¹¶è¡Œä»£ç çš„å®ç°æ–¹æ³•æ˜¯å‘Šè¯‰CUDAè¿è¡Œæ—¶å¯åŠ¨æ ¸å‡½æ•°çš„å¤šä¸ªå¹¶è¡Œå‰¯æœ¬ã€‚æˆ‘ä»¬å°†è¿™äº›å¹¶è¡Œå‰¯æœ¬ç§°ä¸ºçº¿ç¨‹å—(Block)ã€‚
CUDAè¿è¡Œæ—¶å°†æŠŠè¿™äº›çº¿ç¨‹å—åˆ†è§£ä¸ºå¤šä¸ªçº¿ç¨‹ã€‚å½“éœ€è¦å¯åŠ¨å¤šä¸ªå¹¶è¡Œçº¿ç¨‹å—æ—¶ï¼Œåªéœ€å°†å°–æ‹¬å·ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”±1æ”¹ä¸ºæƒ³è¦å¯åŠ¨çš„çº¿ç¨‹å—æ•°é‡ã€‚
åœ¨å°–æ‹¬å·ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºCUDAè¿è¡Œæ—¶åœ¨æ¯ä¸ªçº¿ç¨‹å—ä¸­åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ã€‚å‡è®¾å°–æ‹¬å·ä¸­çš„å˜é‡ä¸º&laquo;&lt;N, M&raquo;&gt;æ€»å…±å¯åŠ¨çš„çº¿ç¨‹æ•°é‡å¯ä»¥æŒ‰ç…§ä»¥ä¸‹å…¬å¼è®¡ç®—: $$ Nä¸ªçº¿ç¨‹å— * Mä¸ªçº¿ç¨‹/çº¿ç¨‹å— = N*Mä¸ªå¹¶è¡Œçº¿ç¨‹ $$
ä½¿ç”¨çº¿ç¨‹å®ç°GPUä¸Šçš„çŸ¢é‡æ±‚å’Œ åœ¨ä¹‹å‰çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ‰å»çš„æ—¶è°ƒç”¨Nä¸ªçº¿ç¨‹å—ï¼Œæ¯ä¸ªçº¿ç¨‹å—å¯¹åº”ä¸€ä¸ªçº¿ç¨‹add&lt;&lt;&lt;N, 1&gt;&gt;&gt;(dev_a, dev_b, dev_c);ã€‚
å¦‚æœæˆ‘ä»¬å¯åŠ¨Nä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”æ‰€æœ‰çº¿ç¨‹éƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹å—ä¸­ï¼Œåˆ™å¯ä»¥è¡¨ç¤ºä¸ºadd&lt;&lt;&lt;1, N&gt;&gt;&gt;(dev_a, dev_b, dev_c);ã€‚æ­¤å¤–ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹å—ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡çº¿ç¨‹ç´¢å¼•æ¥å¯¹æ•°æ®è¿›è¡Œç´¢å¼•(è€Œä¸æ˜¯çº¿ç¨‹å—ç´¢å¼•)ï¼Œéœ€è¦å°†int tid = blockIdx.x;ä¿®æ”¹ä¸ºint tid = threadIdx.x;
åœ¨GPUä¸Šå¯¹æ›´é•¿çš„çŸ¢é‡æ±‚å’Œ å¯¹äºå¯åŠ¨æ ¸å‡½æ•°æ—¶æ¯ä¸ªçº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æ•°é‡ï¼Œç¡¬ä»¶ä¹Ÿè¿›è¡Œäº†é™åˆ¶ã€‚å…·ä½“æ¥è¯´ï¼Œæœ€å¤§çš„çº¿ç¨‹æ•°é‡ä¸èƒ½è¶…è¿‡è®¾å¤‡æ ‘å½¢ç»“æ„ä¸­maxThreadsPerBlockåŸŸçš„å€¼ã€‚å¯¹ç›®å‰çš„GPUæ¥è¯´ä¸€ä¸ªçº¿ç¨‹å—æœ€å¤šæœ‰1024ä¸ªçº¿ç¨‹ã€‚å¦‚æœè¦é€šè¿‡å¹¶è¡Œçº¿ç¨‹å¯¹é•¿åº¦å¤§äº1024çš„çŸ¢é‡è¿›è¡Œç›¸åŠ çš„è¯ï¼Œå°±éœ€è¦å°†çº¿ç¨‹ä¸çº¿ç¨‹å—ç»“åˆèµ·æ¥æ‰èƒ½å®ç°ã€‚
æ­¤æ—¶ï¼Œè®¡ç®—ç´¢å¼•å¯ä»¥è¡¨ç¤ºä¸º:
int tid = threadIdx.x + blockIdx.x * blockDim.x; blockDimä¿å­˜çš„äº‹çº¿ç¨‹å—ä¸­æ¯ä¸€ç»´çš„çº¿ç¨‹æ•°é‡ï¼Œç”±äºä½¿ç”¨çš„äº‹ä¸€ç»´çº¿ç¨‹å—ï¼Œå› æ­¤åªç”¨åˆ°blockDim.xã€‚
æ­¤å¤–ï¼ŒgridDimæ˜¯äºŒç»´çš„ï¼Œè€ŒblockDimæ˜¯ä¸‰ç»´çš„ã€‚
å‡å¦‚æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªçº¿ç¨‹å—å¤„ç†Nä¸ªå¹¶è¡Œçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å—å¤„ç†çš„çº¿ç¨‹æ•°é‡ä¸º128ï¼Œé‚£æ ·å¯ä»¥å¯åŠ¨N/128ä¸ªçº¿ç¨‹å—ã€‚ç„¶è€Œé—®é¢˜åœ¨äºï¼Œå½“Nå°äº128æ—¶ï¼Œæ¯”å¦‚127ï¼Œé‚£ä¹ˆN/128ç­‰äº0ï¼Œæ­¤æ—¶å°†ä¼šå¯åŠ¨0ä¸ªçº¿ç¨‹å—ã€‚æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªé™¤æ³•èƒ½å¤Ÿå‘ä¸Šå–æ•´ã€‚æˆ‘ä»¬å¯ä»¥ä¸ç”¨è°ƒç”¨ ceil()å‡½æ•°ï¼Œè€Œæ˜¯å°†è®¡ç®—æ”¹ä¸º(N+127)/Nã€‚å› æ­¤ï¼Œè¿™ä¸ªä¾‹å­è°ƒç”¨æ ¸å‡½æ•°å¯ä»¥å†™ä¸º:
add&lt;&lt;&lt;(N + 127) / 128, 128&gt;&gt;&gt;(dev_a, dev_b, dev_c); å½“Nä¸æ˜¯128çš„æ•´æ•°å€æ—¶ï¼Œå°†å¯åŠ¨è¿‡å¤šçš„çº¿ç¨‹ã€‚ç„¶è€Œï¼Œåœ¨æ ¸å‡½æ•°ä¸­å·²ç»è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨è®¿é—®è¾“å…¥æ•°ç»„å’Œè¾“å‡ºæ•°ç»„ä¹‹å‰ï¼Œå¿…é¡»æ£€æŸ¥çº¿ç¨‹çš„ä¾¿å®œæ˜¯å¦ä½äº0åˆ°Nä¹‹é—´ã€‚
if(tid &lt; N){ c[tid] = a[tid] + b[tid]; } å› æ­¤ï¼Œå½“ç´¢å¼•è¶Šè¿‡æ•°ç»„çš„è¾¹ç•Œæ—¶ï¼Œæ ¸å‡½æ•°å°†è‡ªåŠ¨åœæ­¢æ‰§è¡Œè®¡ç®—ã€‚æ ¸å‡½æ•°ä¸ä¼šå¯¹è¶Šè¿‡æ•°ç»„è¾¹ç•Œçš„å†…å­˜è¿›è¡Œè¯»å–æˆ–è€…å†™å…¥ã€‚
åœ¨GPUä¸Šå¯¹ä»»æ„é•¿åº¦çš„çŸ¢é‡æ±‚å’Œ å½“çŸ¢é‡çš„é•¿åº¦å¾ˆé•¿æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå¤šä¸ªçŸ¢é‡ç›¸åŠ ã€‚ä¾‹å¦‚
__global__ void add(int *a, int *b, int *c){ int tid = threadIdx.]]></description></item><item><title>CUDAå­¦ä¹ (äºŒ)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%BA%8C/</link><pubDate>Thu, 08 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%BA%8C/</guid><description><![CDATA[è¿™ä¸€éƒ¨åˆ†å°†ä»‹ç»CUDAçš„å¹¶è¡Œç¼–ç¨‹æ–¹å¼
çŸ¢é‡æ±‚å’Œè¿ç®— å‡è®¾æœ‰ä¸¤ç»„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸¤ç»„æ•°æ®ä¸­å¯¹åº”çš„å…ƒç´ ä¸¤ä¸¤ç›¸åŠ ï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨ç¬¬ä¸‰ä¸ªæ•°ç»„ä¸­ã€‚
åŸºäºCPUçš„çŸ¢é‡æ±‚å’Œ é¦–å…ˆï¼Œä¸‹é¢çš„ä»£ç æ˜¯é€šè¿‡ä¼ ç»Ÿçš„Cä»£ç æ¥å®ç°è¿™ä¸ªæ±‚å’Œè¿ç®—
#include &#34;../common/book.h&#34; #define N 10 void add(int *a, int *b, int *c){ int tid = 0;	//è¿™æ˜¯ç¬¬0ä¸ªCPUï¼Œå› æ­¤ç´¢å¼•ä»0å¼€å§‹ while(tid &lt; N){ c[tid] = a[tid] + b[tid]; tid += 1;	//ç”±äºåªæœ‰ä¸€ä¸ªCPUï¼Œå› æ­¤æ¯æ¬¡é€’å¢1 } } int main(){ int a[N], b[N], c[N]; //åœ¨CPUä¸Šä¸ºæ•°ç»„&#34;a&#34;å’Œ&#34;b&#34;èµ‹å€¼ for(int i = 0; i &lt; N; i++){ a[i] = -i; b[i] = i * i; } add(a, b, c); //æ˜¾ç¤ºç»“æœ for(int i = 0; i &lt; N; i++){ printf(&#34;%d + %d = %d\n&#34;, a[i], b[i], c[i]); } return 0; } add()ä¸­ä½¿ç”¨whileå¾ªç¯è€Œä¸æ˜¯forå¾ªç¯æ˜¯ä¸ºäº†ä»£ç èƒ½å¤Ÿåœ¨æ‹¥æœ‰å¤šä¸ªCPUæˆ–è€…å¤šä¸ªCPUæ ¸çš„ç³»ç»Ÿä¸Šå¹¶è¡Œè¿è¡Œï¼Œæ¯”å¦‚åŒæ ¸å¤„ç†å™¨ä¸Šå¯ä»¥å°†æ¯æ¬¡é€’å¢çš„å¤§å°æ”¹ä¸º2ã€‚]]></description></item><item><title>CUDAå­¦ä¹ (ä¸€)</title><link>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%80/</link><pubDate>Sun, 04 Feb 2024 00:00:00 +0000</pubDate><guid>https://KasterMist.com/posts/cuda/cuda%E5%AD%A6%E4%B9%A0-%E4%B8%80/</guid><description><![CDATA[å‚è€ƒä¹¦ç›®: GPUé«˜æ€§èƒ½ç¼–ç¨‹CUDAå®æˆ˜
ä¹¦ç›®ç½‘é¡µé“¾æ¥: https://hpc.pku.edu.cn/docs/20170829223652566150.pdf
è¯¥åšå®¢å‚è€ƒäºä¸Šè¿°ä¹¦ç±ï¼Œè™½ç„¶ä¹¦æœ‰ä¸€ç‚¹è€ï¼Œä½†æ˜¯ä½œä¸ºåˆå­¦è€…è€Œè¨€ä»ç„¶èƒ½å­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚
æœ¬ä¹¦æ‰€åŒ…å«çš„ä»£ç éƒ½åœ¨ä¸‹é¢çš„è¿æ¥ä¸­ï¼Œå¯ä»¥ä¸‹è½½æ¥å­¦ä¹ : https://developer.nvidia.com/cuda-example
CUDA Cç®€ä»‹ é¦–å…ˆæ¥çœ‹ä¸€ä¸ªCUDA Cçš„ç¤ºä¾‹:
#include &#34;../common/book.h&#34; int main(){ prinf(&#34;Hello World!\n&#34;); return 0; } è¿™ä¸ªç¤ºä¾‹åªæ˜¯ä¸ºäº†è¯´æ˜ï¼ŒCUDA Cä¸ç†Ÿæ‚‰çš„æ ‡å‡†Cåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚
æ ¸å‡½æ•°è°ƒç”¨ åœ¨GPUè®¾å¤‡ä¸Šæ‰§è¡Œçš„å‡½æ•°é€šå¸¸ç§°ä¸ºæ ¸å‡½æ•°(Kernel)
#include &lt;iostream&gt; __global__ void kernel(){ } int main(){ kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(); printf(&#34;Hello World!\n&#34;); return 0; } è·Ÿä¹‹å‰çš„ä»£ç ç›¸æ¯”å¤šäº†ä¸¤å¤„
ä¸€ä¸ªç©ºçš„å‡½æ•°kernel()ï¼Œå¹¶ä¸”å¸¦æœ‰ä¿®é¥°ç¬¦__global__ã€‚ å¯¹è¿™ä¸ªç©ºå‡½æ•°çš„è°ƒç”¨ï¼Œå¹¶ä¸”å¸¦æœ‰ä¿®é¥°å­—ç¬¦&laquo;&lt;1, 1&raquo;&gt;ã€‚ è¿™ä¸ª__global__å¯ä»¥è®¤ä¸ºæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå‡½æ•°åº”è¯¥ç¼–è¯‘ä¸ºåœ¨è®¾å¤‡è€Œä¸æ˜¯åœ¨ä¸»æœºä¸Šè¿è¡Œã€‚å‡½æ•°kernel()å°†è¢«äº¤ç»™ç¼–è¯‘å™¨è®¾å¤‡ä»£ç çš„ç¼–è¯‘å™¨ï¼Œè€Œmain()å‡½æ•°å°†è¢«äº¤ç»™ä¸»æœºç¼–è¯‘å™¨ã€‚
ä¼ é€’å‚æ•° ä»¥ä¸‹æ˜¯å¯¹ä¸Šè¿°ä»£ç çš„è¿›ä¸€æ­¥ä¿®æ”¹ï¼Œå¯ä»¥å®ç°å°†å‚æ•°ä¼ é€’ç»™æ ¸å‡½æ•°
#include &lt;iostream&gt; #include &#34;book.h&#34; __global__ void add(int a, int b, int* c){ *c = a + b; printf(&#34;c is %d\n&#34;, *c); } int main(void){ int c = 0; int* dev_c; printf(&#34;original c is %d\n&#34;, c); HANDLE_ERROR(cudaMalloc((void**)&amp;dev_c, sizeof(int))); add&lt;&lt;&lt;1, 1&gt;&gt;&gt;(2, 7, dev_c); HANDLE_ERROR(cudaMemcpy(&amp;c, dev_c, sizeof(int), cudaMemcpyDeviceToHost)); cudaFree(dev_c); printf(&#34;2 + 7 = %d\n&#34;, c); return 0; } å…¶ä¸­&quot;book.]]></description></item></channel></rss>